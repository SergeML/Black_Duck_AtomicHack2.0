# Black_Duck_AtomicHack2.0. Детекция дефектов сварных швов.

## Описание

Этот Telegram-бот предназначен для автоматического определения дефектов сварочных швов по изображениям с помощью мобильного телефона.

Бот поддерживает несколько режимов работы:

* Работа с учениками. Данный режим помимо наглядной демонстрации выявленных дефектов предусматривает вывод релевантных для ученика советов из базы знаний, помогающих предотвратить такие дефекты и улучшить образовательный опыт. 

* Работа со специалистом технического контроля. Данный режим позволяет проводить дефектоскопию сварных швов непосредственно на участке с помощью мобильного телефона, улучшить качество детекции дефектов и ускорить сам процесс непосредственного контроля, а также потенциально позволяет сократить сократить
* издержки на транспартирование деталей. При этом в процессе работы формируется файл-отчёт по всем изображениям, доступный по итогу работы в чате с ботом, а также в коде предусмотрена интеграция с БД 1С.


## Установка

1. Клонируйте репозиторий:
    ```bash
    git clone https://github.com/SergeML/Black_Duck_AtomicHack2.0.git
    ```

2. Перейдите в директорию проекта:
    ```bash
    cd Black_Duck_AtomicHack2.0
    ```

3. Установите необходимые библиотеки:
    ```bash
    pip install -r requirements.txt
    ```

## Использование

Для развёртывания бота выполните команду:
```bash
python bot_petrovich/main.py
```

Также для развертывания необходимо получить токен Telegram-бота и указать его в файле `bot_petrovich/config.py'. Для получения токена нужно перейти в чат по ссылке https://t.me/BotFather и следовать инструкциям внутри чата.

В файле `bot_petrovich/config.py' можно указать параметры подключения к БД 1С, в таком случае отчёты могут выгружаться также непосредственно в БД.


# Telegram-бот для Определения Дефектов Сварных Швов



## Основные Функции
1. **Приём изображений и видео прямо из чата с ботом:**
   - Возможность отправлять снимки сразу в чат и обрабатывать их в реальном времени.
   - Выбор изображений и видеофайлов из памяти телефона, в т.ч. множественный.

2. **Детекция дефектов:**
   - Детекция типов дефектов и соответствующих им областей на изображении по фотографии сварного шва в реальном времени.
   - Передача в изображений с отмеченными дефектами в чат в реальном времени.

3. **Отчёты:**
   - Создание отчёта по выполненному детектированию дефектов.
   - Сохранение отчётов.

4. **Интерфейс с БД 1С:**
   - Подключение к базе данных 1С и отправке в неё отчётов.

## Дополнительные Особенности
- Обработанные изображения помечаются жёлтым кружком на миниатюре для удобства навигации.
- Возможность загрузки и работы с видеофайлами для анализа сварочных швов на каждом кадре.

## Инструкция по Использованию
1. Команда `/start` регистрирует пользователя в боте.
2. Формирование отчётов доступно в режиме специалиста технического контроля. Подсказки для учеников доступны только в образовательном режиме.
Переключение между режимами происходит с помощью команды `/student`
4. Изображения с камеры устройства или его внутренней памяти можно отправлять прямо в чат.
5. Для формирования отчётов используется ряд команд:
 — `/start_repo` — начинает формирование отчётов, все последующие отправленные медиафайлы попадут в отчёт, если в процессе не выполнить сброс отчёта;
 — `/del` — позволяет сбросить текущий отчёт в случае ошибки пользователя (загружено не то изображение) или наличия предыдущих незаконченных отчётов;
 — `/end_repo` — завершает формирование отчёта, сохраняет результаты в табличный файл-отчёт по дефектоскопии, отправляемый пользователю ответным сообщением в чате.
Также возможна выгрузка данных в БД 1С при наличии подключения к БД (необходимо иметь физический доступ к БД и указать в файле `bot_petrovich/config.py` параметры для подключения к БД.
Файл `bot_petrovich/lib.py` содержит базу знаний по группам дефектам, которую при желании можно модифицировать.
